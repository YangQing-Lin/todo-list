# Todo List åŠŸèƒ½è§„åˆ’ä¸å¼€å‘æ’æœŸ

## ğŸ“Š é¡¹ç›®ç°çŠ¶

### å·²å®ç°åŠŸèƒ½
- âœ… åŸºç¡€ CRUD æ“ä½œï¼ˆåˆ›å»ºã€è¯»å–ã€æ›´æ–°ã€åˆ é™¤ï¼‰
- âœ… ä¹è§‚é”æœºåˆ¶ï¼ˆVersion å­—æ®µé˜²æ­¢å¹¶å‘å†²çªï¼‰
- âœ… API ç‰ˆæœ¬æ§åˆ¶ï¼ˆ/api/v1/todos å’Œ /api/todos åŒæ—¶æ”¯æŒï¼‰
- âœ… CORS è·¨åŸŸæ”¯æŒ
- âœ… é”™è¯¯æ¢å¤ä¸­é—´ä»¶
- âœ… ç»Ÿä¸€å“åº”æ ¼å¼
- âœ… å‰ç«¯ React + TypeScript
- âœ… SQLite æ•°æ®åº“æŒä¹…åŒ–

### å‘ç°çš„æŠ€æœ¯å€º
- âŒ **æ•°æ®ä¸ä¸€è‡´**: `database/db.go:49` schema ä¸­æœ‰ `priority` å­—æ®µï¼Œä½† `model.Todo` ä¸­æœªå®šä¹‰
- âš ï¸ **æ€§èƒ½éšæ‚£**: `ListTodos()` è¿”å›å…¨éƒ¨æ•°æ®ï¼Œæ— åˆ†é¡µæœºåˆ¶
- âš ï¸ **åŠŸèƒ½ç¼ºå¤±**: æ— ç­›é€‰ã€æœç´¢ã€æ’åºèƒ½åŠ›

---

## ğŸ¯ åŠŸèƒ½æ¸…å•

### P0 - æ ¸å¿ƒåŠŸèƒ½ï¼ˆç«‹å³å¼€å‘ï¼‰

#### 1.1 ç­›é€‰ã€æœç´¢ã€åˆ†é¡µ API
**åŠŸèƒ½æè¿°**
- æ”¯æŒæŒ‰çŠ¶æ€ç­›é€‰ï¼ˆpending/completedï¼‰
- æ”¯æŒæ ‡é¢˜å’Œæè¿°çš„å…¨æ–‡æœç´¢
- æ”¯æŒå¤šå­—æ®µæ’åºï¼ˆåˆ›å»ºæ—¶é—´/æˆªæ­¢æ—¥æœŸ/çŠ¶æ€ï¼‰
- æ”¯æŒåˆ†é¡µæŸ¥è¯¢ï¼ˆlimit + offsetï¼‰

**API è®¾è®¡**
```
GET /api/v1/todos?status=pending&search=å…³é”®è¯&sort=due_date&order=asc&limit=20&offset=0
```

**æŸ¥è¯¢å‚æ•°**
| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ | é»˜è®¤å€¼ |
|------|------|------|------|--------|
| status | string | å¦ | pending/completed/all | all |
| search | string | å¦ | æœç´¢æ ‡é¢˜å’Œæè¿° | ç©º |
| sort | string | å¦ | created_at/due_date/status | created_at |
| order | string | å¦ | asc/desc | desc |
| limit | int | å¦ | æ¯é¡µæ•°é‡ | 50 |
| offset | int | å¦ | åç§»é‡ | 0 |

**è¿”å›ç¤ºä¾‹**
```json
{
  "success": true,
  "data": {
    "todos": [...],
    "total": 100,
    "limit": 20,
    "offset": 0
  },
  "message": "è·å–å¾…åŠäº‹é¡¹æˆåŠŸ"
}
```

**åç«¯æ”¹åŠ¨**
- `database/db.go`: `ListTodos()` å‡½æ•°å¢åŠ å‚æ•°å’ŒåŠ¨æ€ SQL æ„å»º
- `handler/handler.go`: `ListTodos` è§£ææŸ¥è¯¢å‚æ•°
- `model/todo.go`: æ— éœ€æ”¹åŠ¨

**å‰ç«¯æ”¹åŠ¨**
- æ·»åŠ ç­›é€‰å™¨ç»„ä»¶ï¼ˆçŠ¶æ€é€‰æ‹©ã€æœç´¢æ¡†ï¼‰
- æ·»åŠ æ’åºæ§åˆ¶å™¨
- æ·»åŠ åˆ†é¡µç»„ä»¶

**å‘åå…¼å®¹æ€§**
- âœ… æ‰€æœ‰å‚æ•°ä¸ºå¯é€‰ï¼Œä¸ä¼ å‚æ•°æ—¶è¡Œä¸ºä¸ç°æœ‰ API ä¸€è‡´
- âœ… è¿”å›æ ¼å¼ä¿æŒä¸å˜ï¼Œä»…å¢åŠ  `total/limit/offset` å­—æ®µ

**å·¥ä½œé‡**: 4-6 å°æ—¶

---

#### 1.2 ç»Ÿè®¡ä¿¡æ¯ API
**åŠŸèƒ½æè¿°**
- æä¾›å¾…åŠäº‹é¡¹çš„ç»Ÿè®¡æ•°æ®
- æ”¯æŒé¦–é¡µ Dashboard å±•ç¤º

**API è®¾è®¡**
```
GET /api/v1/todos/stats
```

**è¿”å›ç¤ºä¾‹**
```json
{
  "success": true,
  "data": {
    "total": 50,
    "pending": 25,
    "completed": 25,
    "overdue": 3,
    "today": 5,
    "this_week": 12
  },
  "message": "è·å–ç»Ÿè®¡ä¿¡æ¯æˆåŠŸ"
}
```

**ç»Ÿè®¡ç»´åº¦**
- `total`: æ€»æ•°é‡
- `pending`: æœªå®Œæˆæ•°é‡
- `completed`: å·²å®Œæˆæ•°é‡
- `overdue`: å·²é€¾æœŸæ•°é‡ï¼ˆdue_date < now ä¸” status = pendingï¼‰
- `today`: ä»Šå¤©åˆ°æœŸæ•°é‡
- `this_week`: æœ¬å‘¨åˆ°æœŸæ•°é‡

**åç«¯æ”¹åŠ¨**
- `database/db.go`: æ–°å¢ `GetStats()` å‡½æ•°
- `handler/handler.go`: æ–°å¢ `GetStats` handler
- `api/routes.go`: æ³¨å†Œ `GET /api/v1/todos/stats` è·¯ç”±

**å‰ç«¯æ”¹åŠ¨**
- æ–°å¢ç»Ÿè®¡å¡ç‰‡ç»„ä»¶
- åœ¨é¡µé¢é¡¶éƒ¨å±•ç¤ºå…³é”®æŒ‡æ ‡

**å·¥ä½œé‡**: 2-3 å°æ—¶

---

### P1 - æ•°æ®å®Œæ•´æ€§ä¿®å¤ï¼ˆä¼˜å…ˆå¤„ç†ï¼‰

#### 2.1 æ¸…ç† Priority å­—æ®µ
**é—®é¢˜åˆ†æ**
- æ•°æ®åº“ schema å®šä¹‰äº† `priority` å­—æ®µä½†ä»æœªä½¿ç”¨
- å¯¼è‡´æ•°æ®æ¨¡å‹ä¸æ•°æ®åº“ä¸ä¸€è‡´
- è¿å "åˆ é™¤æ— ç”¨ä»£ç " åŸåˆ™

**è§£å†³æ–¹æ¡ˆ Aï¼ˆæ¨èï¼‰ï¼šåˆ é™¤è¯¥å­—æ®µ**

**æ•°æ®åº“è¿ç§»**
```sql
-- æ­¥éª¤ 1: åˆ›å»ºä¸´æ—¶è¡¨ï¼ˆä¸å« priorityï¼‰
CREATE TABLE todos_new (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    version INTEGER NOT NULL DEFAULT 1,
    title TEXT NOT NULL,
    description TEXT,
    status TEXT NOT NULL DEFAULT 'pending',
    due_date TEXT,
    created_at DATETIME NOT NULL,
    updated_at DATETIME NOT NULL,
    completed_at DATETIME
);

-- æ­¥éª¤ 2: è¿ç§»æ•°æ®
INSERT INTO todos_new
SELECT id, version, title, description, status,
       due_date, created_at, updated_at, completed_at
FROM todos;

-- æ­¥éª¤ 3: åˆ é™¤æ—§è¡¨
DROP TABLE todos;

-- æ­¥éª¤ 4: é‡å‘½åæ–°è¡¨
ALTER TABLE todos_new RENAME TO todos;

-- æ­¥éª¤ 5: é‡å»ºç´¢å¼•
CREATE INDEX idx_status ON todos(status);
CREATE INDEX idx_created_at ON todos(created_at DESC);
```

**ä»£ç æ”¹åŠ¨**
- `database/db.go`: æ›´æ–° `initSchema()` ä¸­çš„ schema å®šä¹‰
- æ·»åŠ ç‰ˆæœ¬æ£€æŸ¥å’Œè‡ªåŠ¨è¿ç§»é€»è¾‘

**å·¥ä½œé‡**: 2 å°æ—¶

---

**è§£å†³æ–¹æ¡ˆ Bï¼šå®ç° Priority åŠŸèƒ½**

**æ•°æ®æ¨¡å‹**
```go
type Todo struct {
    // ... ç°æœ‰å­—æ®µ
    Priority int `json:"priority"` // 1=ä½, 2=ä¸­, 3=é«˜
}
```

**API æ”¹åŠ¨**
- åˆ›å»º/æ›´æ–°æ—¶æ”¯æŒè®¾ç½® priority
- æ”¯æŒæŒ‰ä¼˜å…ˆçº§æ’åº
- ç­›é€‰ API æ”¯æŒæŒ‰ä¼˜å…ˆçº§è¿‡æ»¤

**å‰ç«¯æ”¹åŠ¨**
- æ·»åŠ ä¼˜å…ˆçº§é€‰æ‹©å™¨
- Todo åˆ—è¡¨æ˜¾ç¤ºä¼˜å…ˆçº§æ ‡è¯†ï¼ˆé¢œè‰²/å›¾æ ‡ï¼‰

**å·¥ä½œé‡**: 4-5 å°æ—¶

**æ¨è**: é€‰æ‹©æ–¹æ¡ˆ Aï¼Œå› ä¸ºè¿™æ˜¯å­¦ä¹ é¡¹ç›®ï¼Œä¿æŒç®€æ´æ›´é‡è¦ã€‚

---

### P1 - ä½“éªŒä¼˜åŒ–ï¼ˆæ¨èå®ç°ï¼‰

#### 3.1 æ‰¹é‡æ“ä½œ API
**åŠŸèƒ½æè¿°**
- æ‰¹é‡å®Œæˆå¾…åŠäº‹é¡¹
- æ‰¹é‡åˆ é™¤å¾…åŠäº‹é¡¹

**API è®¾è®¡**
```
POST /api/v1/todos/batch/complete
Body: { "ids": [1, 2, 3] }

DELETE /api/v1/todos/batch
Body: { "ids": [1, 2, 3] }
```

**è¿”å›ç¤ºä¾‹**
```json
{
  "success": true,
  "data": {
    "success_count": 2,
    "failed_count": 1,
    "errors": [
      { "id": 3, "error": "å¾…åŠäº‹é¡¹ä¸å­˜åœ¨" }
    ]
  },
  "message": "æ‰¹é‡æ“ä½œå®Œæˆ"
}
```

**åç«¯æ”¹åŠ¨**
- `database/db.go`: æ–°å¢ `BatchCompleteTodos()` å’Œ `BatchDeleteTodos()`
- ä½¿ç”¨äº‹åŠ¡ä¿è¯åŸå­æ€§
- `handler/handler.go`: æ–°å¢å¯¹åº” handlers

**å‰ç«¯æ”¹åŠ¨**
- Todo åˆ—è¡¨æ”¯æŒå¤šé€‰ï¼ˆcheckboxï¼‰
- æ·»åŠ æ‰¹é‡æ“ä½œæŒ‰é’®

**å·¥ä½œé‡**: 3-4 å°æ—¶

---

#### 3.2 æˆªæ­¢æ—¥æœŸæé†’
**åŠŸèƒ½æè¿°**
- é«˜äº®æ˜¾ç¤ºå³å°†åˆ°æœŸçš„å¾…åŠäº‹é¡¹
- é€¾æœŸçš„å¾…åŠäº‹é¡¹ç‰¹æ®Šæ ‡è®°

**å‰ç«¯å®ç°**
- æ·»åŠ æ—¥æœŸè®¡ç®—é€»è¾‘
- æ ¹æ®æ—¶é—´å·®åº”ç”¨ä¸åŒæ ·å¼
  - å·²é€¾æœŸ: çº¢è‰²
  - 24 å°æ—¶å†…åˆ°æœŸ: æ©™è‰²
  - 3 å¤©å†…åˆ°æœŸ: é»„è‰²

**æ— éœ€åç«¯æ”¹åŠ¨**

**å·¥ä½œé‡**: 1-2 å°æ—¶

---

### P2 - å¢å¼ºåŠŸèƒ½ï¼ˆå¯é€‰å®ç°ï¼‰

#### 4.1 å¯¼å‡ºåŠŸèƒ½
**API è®¾è®¡**
```
GET /api/v1/todos/export?format=json
GET /api/v1/todos/export?format=csv
```

**æ”¯æŒæ ¼å¼**
- JSON: æ ‡å‡† JSON æ•°ç»„
- CSV: æ ‡é¢˜, æè¿°, çŠ¶æ€, æˆªæ­¢æ—¥æœŸ, åˆ›å»ºæ—¶é—´

**å·¥ä½œé‡**: 2-3 å°æ—¶

---

#### 4.2 å›æ”¶ç«™åŠŸèƒ½
**åŠŸèƒ½æè¿°**
- åˆ é™¤æ—¶æ ‡è®°ä¸ºå·²åˆ é™¤è€Œéç‰©ç†åˆ é™¤
- æ”¯æŒæ¢å¤å·²åˆ é™¤çš„å¾…åŠäº‹é¡¹
- æ”¯æŒæ°¸ä¹…åˆ é™¤

**æ•°æ®æ¨¡å‹æ”¹åŠ¨**
```go
type Todo struct {
    // ... ç°æœ‰å­—æ®µ
    DeletedAt *time.Time `json:"deleted_at,omitempty"`
}
```

**API æ”¹åŠ¨**
- `DELETE /api/v1/todos/{id}` â†’ è½¯åˆ é™¤
- `POST /api/v1/todos/{id}/restore` â†’ æ¢å¤
- `DELETE /api/v1/todos/{id}/permanently` â†’ æ°¸ä¹…åˆ é™¤
- `GET /api/v1/todos/trash` â†’ æŸ¥çœ‹å›æ”¶ç«™

**å·¥ä½œé‡**: 4-5 å°æ—¶

---

## ğŸ“… å¼€å‘æ’æœŸ

### Sprint 1: æ ¸å¿ƒåŠŸèƒ½å¢å¼ºï¼ˆ1 å‘¨ï¼‰

**Day 1-2: ç­›é€‰æœç´¢åˆ†é¡µ**
- [ ] åç«¯å®ç°åŠ¨æ€ SQL æ„å»º
- [ ] Handler è§£ææŸ¥è¯¢å‚æ•°
- [ ] å•å…ƒæµ‹è¯•
- [ ] API æ–‡æ¡£æ›´æ–°

**Day 3: ç»Ÿè®¡ API**
- [ ] æ•°æ®åº“ç»Ÿè®¡æŸ¥è¯¢å®ç°
- [ ] Handler å’Œè·¯ç”±æ³¨å†Œ
- [ ] æµ‹è¯•éªŒè¯

**Day 4-5: å‰ç«¯é€‚é…**
- [ ] ç­›é€‰å™¨ç»„ä»¶å¼€å‘
- [ ] åˆ†é¡µç»„ä»¶å¼€å‘
- [ ] ç»Ÿè®¡å¡ç‰‡ç»„ä»¶
- [ ] é›†æˆæµ‹è¯•

**Day 6-7: æ•°æ®å®Œæ•´æ€§ä¿®å¤**
- [ ] æ•°æ®åº“è¿ç§»è„šæœ¬
- [ ] åˆ é™¤ priority å­—æ®µ
- [ ] å›å½’æµ‹è¯•
- [ ] æ–‡æ¡£æ›´æ–°

---

### Sprint 2: ä½“éªŒä¼˜åŒ–ï¼ˆ3-5 å¤©ï¼‰

**Day 1-2: æ‰¹é‡æ“ä½œ**
- [ ] åç«¯æ‰¹é‡ API å®ç°
- [ ] å‰ç«¯å¤šé€‰åŠŸèƒ½
- [ ] æ‰¹é‡æ“ä½œæŒ‰é’®
- [ ] æµ‹è¯•

**Day 3: æˆªæ­¢æ—¥æœŸæé†’**
- [ ] å‰ç«¯æ—¥æœŸé€»è¾‘
- [ ] æ ·å¼è°ƒæ•´
- [ ] è§†è§‰æµ‹è¯•

**Day 4-5: æµ‹è¯•å’Œä¼˜åŒ–**
- [ ] æ€§èƒ½æµ‹è¯•
- [ ] ç”¨æˆ·ä½“éªŒä¼˜åŒ–
- [ ] Bug ä¿®å¤

---

### Sprint 3: å¢å¼ºåŠŸèƒ½ï¼ˆå¯é€‰ï¼Œ1 å‘¨ï¼‰

**Day 1-2: å¯¼å‡ºåŠŸèƒ½**
- [ ] åç«¯å¯¼å‡ºé€»è¾‘
- [ ] CSV ç”Ÿæˆ
- [ ] å‰ç«¯ä¸‹è½½æŒ‰é’®

**Day 3-5: å›æ”¶ç«™åŠŸèƒ½**
- [ ] è½¯åˆ é™¤é€»è¾‘
- [ ] æ¢å¤ API
- [ ] å›æ”¶ç«™é¡µé¢
- [ ] æµ‹è¯•

---

## ğŸ”§ æŠ€æœ¯å®ç°è¦ç‚¹

### 1. åŠ¨æ€ SQL æ„å»º
```go
func (db *DB) ListTodos(filter TodoFilter) ([]model.Todo, int, error) {
    query := "SELECT * FROM todos WHERE 1=1"
    args := []interface{}{}

    if filter.Status != "" && filter.Status != "all" {
        query += " AND status = ?"
        args = append(args, filter.Status)
    }

    if filter.Search != "" {
        query += " AND (title LIKE ? OR description LIKE ?)"
        search := "%" + filter.Search + "%"
        args = append(args, search, search)
    }

    // å…ˆæŸ¥æ€»æ•°
    countQuery := "SELECT COUNT(*) FROM (" + query + ")"
    var total int
    db.conn.QueryRow(countQuery, args...).Scan(&total)

    // æ·»åŠ æ’åºå’Œåˆ†é¡µ
    query += fmt.Sprintf(" ORDER BY %s %s LIMIT ? OFFSET ?",
        filter.Sort, filter.Order)
    args = append(args, filter.Limit, filter.Offset)

    // æ‰§è¡ŒæŸ¥è¯¢
    // ...
}
```

### 2. å‘åå…¼å®¹æ€§ä¿è¯
- âœ… æ‰€æœ‰æ–°å¢å‚æ•°ä¸ºå¯é€‰
- âœ… ä¸ä¼ å‚æ•°æ—¶é»˜è®¤è¡Œä¸ºä¸æ—§ç‰ˆæœ¬ä¸€è‡´
- âœ… è¿”å›æ ¼å¼å‘åå…¼å®¹ï¼ˆæ–°å¢å­—æ®µä¸å½±å“è€å®¢æˆ·ç«¯ï¼‰
- âœ… ä¿ç•™ `/api/todos` åˆ«å

### 3. æµ‹è¯•è¦†ç›–
- å•å…ƒæµ‹è¯•: æ‰€æœ‰æ•°æ®åº“æ“ä½œå‡½æ•°
- é›†æˆæµ‹è¯•: API ç«¯åˆ°ç«¯æµ‹è¯•
- è¾¹ç•Œæ¡ä»¶: ç©ºæ•°æ®ã€è¶…å¤§æ•°æ®é‡ã€ç‰¹æ®Šå­—ç¬¦

### 4. æ€§èƒ½è€ƒè™‘
- ä¸ºå¸¸ç”¨æŸ¥è¯¢å­—æ®µæ·»åŠ ç´¢å¼•
- åˆ†é¡µæ—¶å…ˆæŸ¥æ€»æ•°å†æŸ¥æ•°æ®ï¼ˆé¿å…ä¸¤æ¬¡å…¨è¡¨æ‰«æï¼‰
- æœç´¢ä½¿ç”¨ LIKE æ—¶æ·»åŠ  `%` é€šé…ç¬¦

---

## âŒ ä¸æ¨èå¼€å‘çš„åŠŸèƒ½

### è¿‡åº¦è®¾è®¡ï¼ˆYAGNI åŸåˆ™ï¼‰
- âŒ ç”¨æˆ·è®¤è¯ç³»ç»Ÿï¼ˆå•ç”¨æˆ·åº”ç”¨ä¸éœ€è¦ï¼‰
- âŒ æ ‡ç­¾/åˆ†ç±»ç³»ç»Ÿï¼ˆå¢åŠ å¤æ‚åº¦ï¼Œæ”¶ç›Šæœ‰é™ï¼‰
- âŒ å­ä»»åŠ¡/ä¾èµ–å…³ç³»ï¼ˆæ•°æ®ç»“æ„ä¼šå˜å¾—å¤æ‚ï¼‰
- âŒ é™„ä»¶ä¸Šä¼ ï¼ˆåç¦»å­¦ä¹ ç›®æ ‡ï¼‰
- âŒ Markdown ç¼–è¾‘å™¨ï¼ˆå‰ç«¯å·¥ä½œé‡å¤§ï¼‰
- âŒ WebSocket å®æ—¶åŒæ­¥ï¼ˆè¿‡åº¦å·¥ç¨‹åŒ–ï¼‰
- âŒ é‚®ä»¶/æ¨é€æé†’ï¼ˆéœ€è¦å¤–éƒ¨æœåŠ¡ï¼‰

**Linus è¯´**: "Theory and practice sometimes clash. Theory loses. Every single time."

è¿™äº›åŠŸèƒ½åœ¨ç†è®ºä¸Š"å¾ˆé…·"ï¼Œä½†å®é™…ä¸Šä½ ä¸ä¼šç”¨åˆ°ã€‚ä¿æŒç®€æ´ï¼Œä¸“æ³¨äºè§£å†³çœŸå®é—®é¢˜ã€‚

---

## ğŸ“ æ€»ç»“

### æ ¸å¿ƒåŸåˆ™
1. **å‘åå…¼å®¹**: Never break userspace
2. **ä¿æŒç®€æ´**: æ¶ˆé™¤æ— ç”¨ä»£ç å’Œå­—æ®µ
3. **è§£å†³ç—›ç‚¹**: åªåšçœŸæ­£éœ€è¦çš„åŠŸèƒ½
4. **æ¸è¿›å¢å¼º**: ä»æ ¸å¿ƒåŠŸèƒ½å¼€å§‹ï¼Œé€æ­¥æ‰©å±•

### æœ€å°å¯è¡Œæ–¹æ¡ˆï¼ˆMVPï¼‰
```
Sprint 1 (1å‘¨) â†’ ç­›é€‰ + æœç´¢ + åˆ†é¡µ + ç»Ÿè®¡ + æ¸…ç† priority
```

è¿™ä¸ª MVP å°±èƒ½è§£å†³ 90% çš„å®é™…éœ€æ±‚ï¼Œå‰©ä¸‹çš„åŠŸèƒ½å¯ä»¥æ ¹æ®ä½¿ç”¨åé¦ˆå†å†³å®šæ˜¯å¦å®ç°ã€‚

### è´¨é‡ä¿è¯
- âœ… æ¯ä¸ªåŠŸèƒ½éƒ½æœ‰æµ‹è¯•è¦†ç›–
- âœ… API æ–‡æ¡£ä¸ä»£ç åŒæ­¥æ›´æ–°
- âœ… ä¿æŒä»£ç é£æ ¼ä¸€è‡´ï¼ˆgofmtï¼‰
- âœ… æ€§èƒ½æµ‹è¯•ï¼ˆ10000 æ¡æ•°æ®æ—¶çš„å“åº”æ—¶é—´ï¼‰

---

**"Talk is cheap. Show me the code."** - Linus Torvalds

å¼€å§‹ç¼–ç å§ï¼
